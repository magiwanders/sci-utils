(function(c){typeof define=="function"&&define.amd?define(c):c()})(function(){"use strict";console.log("SCI Utilities!"),document.getElementById("calculate").onclick=async()=>{let e=c(document.getElementById("metric").value),t=await g(e);document.getElementById("results").innerHTML=JSON.stringify(t,null,4)};function c(e){switch(e){case"gdp":return{page:"List_of_continents_by_GDP",title:"GDP in US Billions",table:0,fromRow:2,toRow:7,fromCol:1,toCol:2};case"gdppp":return{page:"List_of_continents_by_GDP",title:"GDP in US Billions (PPP Adjusted)",table:1,fromRow:2,toRow:7,fromCol:1,toCol:2};case"gdppc":return{page:"List_of_continents_by_GDP",title:"GDP Per Capita in US Dollars",table:2,fromRow:2,toRow:7,fromCol:1,toCol:2};case"gdppcpp":return{page:"List_of_continents_by_GDP",title:"GDP Per Capita in US Dollars (PPP Adjusted)",table:3,fromRow:2,toRow:7,fromCol:1,toCol:2};case"pop":return{page:"List_of_continents_and_continental_subregions_by_population",title:"Population",table:0,fromRow:2,toRow:7,fromCol:0,toCol:1};case"energy":return{page:"List_of_countries_by_electricity_consumption",title:"Energy consumption in exaJoule",table:1,fromRow:1,toRow:6,fromCol:0,toCol:1};case"refugees":return{page:"List_of_countries_by_refugee_population",title:"Refugees or refugee-like population by hosting continent",table:2,fromRow:1,toRow:6,fromCol:0,toCol:1}}}async function g(e){let t="https://www.wikitable2json.com/api/"+e.page+"?table="+e.table+"&lang=en&cleanRef=false",o=await fetch(t).then(a=>a.json().then(i=>i)),n=u(o[0],e.fromRow,e.toRow,e.fromCol,e.toCol);return _(d(n),e.title)}function _(e,t){let o={title:t};for(let n of e)o[n[0]]={reale:n[1],persone:n[2]};return o}function d(e){let t=w(e,1),o=t.reduce((l,f)=>l+f,0),n=document.getElementById("participants").value,a=o/n,i=Math.min(...t),p=t.map(l=>n*(l-i)/(o-i)),r=p.map(l=>Math.round(l));for(;C(r,n)!=0;){let l=o,f=0;for(let s=0;s<r.length;s++){let m=Math.abs(p[s]-a*(r[s]+1));m<l&&(l=m,f=s)}r[f]+=1}for(let l in e)e[l].push(r[l]);return e.unshift(["Total",o,n]),e}function u(e,t,o,n,a){return e.slice(t,o+1).map(i=>i.slice(n,a+1))}function w(e,t){return u(e,0,e.length,t,t+1).map(o=>parseInt(o[0].replaceAll(",","")))}function C(e,t){return t-e.reduce((o,n)=>o+n,0)}});
